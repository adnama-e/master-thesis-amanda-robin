from datetime import datetime as dt
import boto3
from decimal import Decimal
from statistics import mean, stdev
import json

"""
Lambda handler for AWS Lambda.

Performs the post-drive analytics of BRUM.
Triggers when new driving data is uploaded to AWS DynamoDB.

Should preferably be written in Go for the final product. 
"""

OVERVIEW_TABLE = "brum-mobilehub-858586794-Overview"


def lambda_handler(event, context):
	image = event['Records'][0]['dynamodb']['NewImage']
	datetimes = [date['S'] for date in image['datetime']['L']]
	user_id = image['userId']['S']
	drive_id = image['driveId']['S']

	scores = []
	for score in image['score']['L']:
		if score['S'] != 'nan':
			scores.append(float(score['S']))

	# Fetch the database and get tables
	db = boto3.resource('dynamodb')
	overview_table = db.Table(OVERVIEW_TABLE)

	# Do the calculations
	avg = mean(scores)
	dev = stdev(scores, avg)
	imp = improvement_score(dev, avg)
	eco = eco_score(scores, avg, dev)
	dur = duration(datetimes)

	# Upload to the overview table
	overview_table.put_item(
		Item={
			'userId': user_id,
			'driveId': drive_id,
			'ecoScore': Decimal(str(eco)),
			'improvementScore': Decimal(str(imp)),
			'duration': str(dur),
			'date': datetimes[0][:-9]
		}
	)
	return "Success!"


def eco_score(scores, avg, dev):
	"""
	:param scores: 
	:return: 
	"""
	# TODO Not sure about this one.
	num_outside = 0
	for score in scores:
		if score > avg + dev or score < avg - dev:
			num_outside += 1
	return 1 - num_outside / len(scores)


def improvement_score(dev, avg):
	"""
	Ranges between 0 and 1 and a value over 0.5 means improvement.
	:return: The improvement score
	"""
	deviation_area = dev * 2
	improvement_area = avg + dev
	return improvement_area / deviation_area


def duration(datetime):
	"""
	Total duration in time.
	:param datetime: The collected datetimes instances from running the app. 
	:return: The duration between the first instance and the last. 
	"""
	date_pattern = "%a, %d %b %Y %H:%M:%S"
	start_time = dt.strptime(datetime[0], date_pattern)
	end_time = dt.strptime(datetime[-1], date_pattern)
	print(datetime[0])
	return end_time - start_time


# if __name__ == "__main__":
# 	event = {'Records': [{'eventID': '351c12360492ff480ee37a29e0a98298', 'eventName': 'MODIFY', 'eventVersion': '1.1', 'eventSource': 'aws:dynamodb', 'awsRegion': 'eu-west-1', 'dynamodb': {'ApproximateCreationDateTime': 1524831900.0, 'Keys': {'driveId': {'S': '1'}, 'userId': {'S': 'devdata'}}, 'NewImage': {'score': {'L': [{'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': '-0.0203111657762'}, {'S': '-0.0379806795168'}, {'S': '-0.00148993257648'}, {'S': '0.023072343844'}, {'S': '0.00075501304136'}, {'S': '0.000136965963543'}, {'S': '-0.0201446627137'}, {'S': '-0.0653481960255'}, {'S': '0.102688433734'}, {'S': '0.00011547152004'}, {'S': '-0.0738907230064'}, {'S': '0.0866256438468'}, {'S': '-1.59449896675e-06'}, {'S': '-0.00167951233662'}, {'S': '0.00896458161516'}, {'S': '-0.103395883499'}, {'S': '0.000489810043931'}, {'S': '-0.0398885698292'}, {'S': '2.27761325355e-08'}, {'S': '0.034833193082'}, {'S': '-0.0430083157312'}, {'S': '0.00763060408119'}, {'S': '-0.00741900967361'}, {'S': '0.00228055415359'}, {'S': '0.00188985542099'}, {'S': '-0.00184568401054'}, {'S': '1.54754440007e-06'}, {'S': '8.43520210225e-06'}, {'S': '-0.018573144593'}, {'S': '-0.00587048017247'}, {'S': '-0.000103925164097'}, {'S': '-0.173801806308'}, {'S': '-0.0621808863845'}, {'S': '-0.0223329036931'}, {'S': '0.00574432758843'}, {'S': '0.02913064801'}, {'S': '-0.0080250963089'}, {'S': '0.00214422902031'}, {'S': '0.00369908660085'}, {'S': '-0.307484435114'}, {'S': '-0.160691406485'}, {'S': '0.0463856001094'}, {'S': '-0.196031629624'}, {'S': '0.000278386744332'}, {'S': '-0.0253034225094'}, {'S': '-0.0618734729466'}, {'S': '-0.0102558456406'}, {'S': '0.576805380866'}, {'S': '0.00189269977714'}, {'S': '0.0758558860167'}, {'S': '2.27406347065e-05'}, {'S': '0.00116052529232'}, {'S': '-0.0162517208754'}, {'S': '-0.0138971320077'}, {'S': '-0.0954407407658'}, {'S': '-0.0348127740803'}, {'S': '0.967496766844'}, {'S': '0.0207045860688'}, {'S': '0.00554737752883'}, {'S': '6.16259589559e-05'}, {'S': '-0.00267757418445'}, {'S': '-0.405689930894'}, {'S': '-0.393976420313'}, {'S': '-0.257838291577'}, {'S': '0.00358394225776'}, {'S': '-0.0400890155931'}, {'S': '0.0877592024507'}, {'S': '0.00466994574901'}, {'S': '-0.00367460700161'}, {'S': '-0.00360673981633'}, {'S': '-0.00963583003307'}, {'S': '-0.00422707914135'}, {'S': '-0.0113042314844'}, {'S': '-0.276803465736'}, {'S': '-0.0872599608318'}, {'S': '0.0485569157434'}, {'S': '0.00313086413305'}, {'S': '-0.00702809862709'}, {'S': '-0.00131231104348'}, {'S': '-0.0291920796464'}, {'S': '-0.0713665065774'}, {'S': '-0.0559727490337'}, {'S': '-0.027040981151'}, {'S': '0.000486392254015'}, {'S': '-0.000840142024016'}, {'S': '-0.000317500428227'}, {'S': '-0.0182216119454'}, {'S': '-0.000886768085992'}, {'S': '0.00238627094217'}, {'S': '-0.0664401296621'}, {'S': '-0.0806759942323'}, {'S': '-0.126721579975'}, {'S': '-0.332355977314'}, {'S': '0.0697560517414'}, {'S': '-0.0480556331388'}, {'S': '-0.162165732708'}, {'S': '0.394988691444'}, {'S': '0.00241254980106'}]}, 'datetime': {'L': [{'S': 'Fri, 27 Apr 2018 14:25:41'}, {'S': 'Fri, 27 Apr 2018 14:25:42'}, {'S': 'Fri, 27 Apr 2018 14:25:43'}, {'S': 'Fri, 27 Apr 2018 14:25:44'}, {'S': 'Fri, 27 Apr 2018 14:25:45'}, {'S': 'Fri, 27 Apr 2018 14:25:46'}, {'S': 'Fri, 27 Apr 2018 14:25:47'}, {'S': 'Fri, 27 Apr 2018 14:25:48'}, {'S': 'Fri, 27 Apr 2018 14:25:49'}, {'S': 'Fri, 27 Apr 2018 14:25:50'}, {'S': 'Fri, 27 Apr 2018 14:25:51'}, {'S': 'Fri, 27 Apr 2018 14:25:52'}, {'S': 'Fri, 27 Apr 2018 14:25:53'}, {'S': 'Fri, 27 Apr 2018 14:25:54'}, {'S': 'Fri, 27 Apr 2018 14:25:55'}, {'S': 'Fri, 27 Apr 2018 14:25:56'}, {'S': 'Fri, 27 Apr 2018 14:25:57'}, {'S': 'Fri, 27 Apr 2018 14:25:58'}, {'S': 'Fri, 27 Apr 2018 14:25:59'}, {'S': 'Fri, 27 Apr 2018 14:26:00'}, {'S': 'Fri, 27 Apr 2018 14:26:01'}, {'S': 'Fri, 27 Apr 2018 14:26:02'}, {'S': 'Fri, 27 Apr 2018 14:26:03'}, {'S': 'Fri, 27 Apr 2018 14:26:04'}, {'S': 'Fri, 27 Apr 2018 14:26:05'}, {'S': 'Fri, 27 Apr 2018 14:26:06'}, {'S': 'Fri, 27 Apr 2018 14:26:07'}, {'S': 'Fri, 27 Apr 2018 14:26:08'}, {'S': 'Fri, 27 Apr 2018 14:26:09'}, {'S': 'Fri, 27 Apr 2018 14:26:10'}, {'S': 'Fri, 27 Apr 2018 14:26:11'}, {'S': 'Fri, 27 Apr 2018 14:26:12'}, {'S': 'Fri, 27 Apr 2018 14:26:13'}, {'S': 'Fri, 27 Apr 2018 14:26:14'}, {'S': 'Fri, 27 Apr 2018 14:26:15'}, {'S': 'Fri, 27 Apr 2018 14:26:16'}, {'S': 'Fri, 27 Apr 2018 14:26:17'}, {'S': 'Fri, 27 Apr 2018 14:26:18'}, {'S': 'Fri, 27 Apr 2018 14:26:19'}, {'S': 'Fri, 27 Apr 2018 14:26:20'}, {'S': 'Fri, 27 Apr 2018 14:26:21'}, {'S': 'Fri, 27 Apr 2018 14:26:22'}, {'S': 'Fri, 27 Apr 2018 14:26:23'}, {'S': 'Fri, 27 Apr 2018 14:26:24'}, {'S': 'Fri, 27 Apr 2018 14:26:25'}, {'S': 'Fri, 27 Apr 2018 14:26:26'}, {'S': 'Fri, 27 Apr 2018 14:26:27'}, {'S': 'Fri, 27 Apr 2018 14:26:28'}, {'S': 'Fri, 27 Apr 2018 14:26:29'}, {'S': 'Fri, 27 Apr 2018 14:26:30'}, {'S': 'Fri, 27 Apr 2018 14:26:31'}, {'S': 'Fri, 27 Apr 2018 14:26:32'}, {'S': 'Fri, 27 Apr 2018 14:26:33'}, {'S': 'Fri, 27 Apr 2018 14:26:34'}, {'S': 'Fri, 27 Apr 2018 14:26:35'}, {'S': 'Fri, 27 Apr 2018 14:26:36'}, {'S': 'Fri, 27 Apr 2018 14:26:37'}, {'S': 'Fri, 27 Apr 2018 14:26:38'}, {'S': 'Fri, 27 Apr 2018 14:26:39'}, {'S': 'Fri, 27 Apr 2018 14:26:40'}, {'S': 'Fri, 27 Apr 2018 14:26:41'}, {'S': 'Fri, 27 Apr 2018 14:26:42'}, {'S': 'Fri, 27 Apr 2018 14:26:43'}, {'S': 'Fri, 27 Apr 2018 14:26:44'}, {'S': 'Fri, 27 Apr 2018 14:26:45'}, {'S': 'Fri, 27 Apr 2018 14:26:46'}, {'S': 'Fri, 27 Apr 2018 14:26:47'}, {'S': 'Fri, 27 Apr 2018 14:26:48'}, {'S': 'Fri, 27 Apr 2018 14:26:49'}, {'S': 'Fri, 27 Apr 2018 14:26:50'}, {'S': 'Fri, 27 Apr 2018 14:26:51'}, {'S': 'Fri, 27 Apr 2018 14:26:52'}, {'S': 'Fri, 27 Apr 2018 14:26:53'}, {'S': 'Fri, 27 Apr 2018 14:26:54'}, {'S': 'Fri, 27 Apr 2018 14:26:55'}, {'S': 'Fri, 27 Apr 2018 14:26:56'}, {'S': 'Fri, 27 Apr 2018 14:26:57'}, {'S': 'Fri, 27 Apr 2018 14:26:58'}, {'S': 'Fri, 27 Apr 2018 14:26:59'}, {'S': 'Fri, 27 Apr 2018 14:27:00'}, {'S': 'Fri, 27 Apr 2018 14:27:01'}, {'S': 'Fri, 27 Apr 2018 14:27:02'}, {'S': 'Fri, 27 Apr 2018 14:27:03'}, {'S': 'Fri, 27 Apr 2018 14:27:04'}, {'S': 'Fri, 27 Apr 2018 14:27:05'}, {'S': 'Fri, 27 Apr 2018 14:27:06'}, {'S': 'Fri, 27 Apr 2018 14:27:07'}, {'S': 'Fri, 27 Apr 2018 14:27:08'}, {'S': 'Fri, 27 Apr 2018 14:27:09'}, {'S': 'Fri, 27 Apr 2018 14:27:10'}, {'S': 'Fri, 27 Apr 2018 14:27:11'}, {'S': 'Fri, 27 Apr 2018 14:27:12'}, {'S': 'Fri, 27 Apr 2018 14:27:13'}, {'S': 'Fri, 27 Apr 2018 14:27:14'}, {'S': 'Fri, 27 Apr 2018 14:27:15'}, {'S': 'Fri, 27 Apr 2018 14:27:16'}, {'S': 'Fri, 27 Apr 2018 14:27:17'}, {'S': 'Fri, 27 Apr 2018 14:27:18'}, {'S': 'Fri, 27 Apr 2018 14:27:19'}, {'S': 'Fri, 27 Apr 2018 14:27:20'}, {'S': 'Fri, 27 Apr 2018 14:27:21'}, {'S': 'Fri, 27 Apr 2018 14:27:22'}, {'S': 'Fri, 27 Apr 2018 14:27:23'}, {'S': 'Fri, 27 Apr 2018 14:27:24'}, {'S': 'Fri, 27 Apr 2018 14:27:25'}, {'S': 'Fri, 27 Apr 2018 14:27:26'}, {'S': 'Fri, 27 Apr 2018 14:27:27'}, {'S': 'Fri, 27 Apr 2018 14:27:28'}, {'S': 'Fri, 27 Apr 2018 14:27:29'}, {'S': 'Fri, 27 Apr 2018 14:27:30'}, {'S': 'Fri, 27 Apr 2018 14:27:31'}, {'S': 'Fri, 27 Apr 2018 14:27:32'}, {'S': 'Fri, 27 Apr 2018 14:27:33'}, {'S': 'Fri, 27 Apr 2018 14:27:34'}, {'S': 'Fri, 27 Apr 2018 14:27:35'}, {'S': 'Fri, 27 Apr 2018 14:27:36'}, {'S': 'Fri, 27 Apr 2018 14:27:37'}, {'S': 'Fri, 27 Apr 2018 14:27:38'}, {'S': 'Fri, 27 Apr 2018 14:27:39'}, {'S': 'Fri, 27 Apr 2018 14:27:40'}, {'S': 'Fri, 27 Apr 2018 14:27:41'}, {'S': 'Fri, 27 Apr 2018 14:27:42'}, {'S': 'Fri, 27 Apr 2018 14:27:43'}, {'S': 'Fri, 27 Apr 2018 14:27:44'}, {'S': 'Fri, 27 Apr 2018 14:27:45'}, {'S': 'Fri, 27 Apr 2018 14:27:46'}, {'S': 'Fri, 27 Apr 2018 14:27:47'}, {'S': 'Fri, 27 Apr 2018 14:27:48'}, {'S': 'Fri, 27 Apr 2018 14:27:49'}, {'S': 'Fri, 27 Apr 2018 14:27:50'}, {'S': 'Fri, 27 Apr 2018 14:27:51'}, {'S': 'Fri, 27 Apr 2018 14:27:52'}, {'S': 'Fri, 27 Apr 2018 14:27:53'}, {'S': 'Fri, 27 Apr 2018 14:27:54'}, {'S': 'Fri, 27 Apr 2018 14:27:55'}, {'S': 'Fri, 27 Apr 2018 14:27:56'}, {'S': 'Fri, 27 Apr 2018 14:27:57'}, {'S': 'Fri, 27 Apr 2018 14:27:58'}, {'S': 'Fri, 27 Apr 2018 14:27:59'}, {'S': 'Fri, 27 Apr 2018 14:28:00'}, {'S': 'Fri, 27 Apr 2018 14:28:01'}, {'S': 'Fri, 27 Apr 2018 14:28:02'}, {'S': 'Fri, 27 Apr 2018 14:28:03'}, {'S': 'Fri, 27 Apr 2018 14:28:04'}, {'S': 'Fri, 27 Apr 2018 14:28:05'}, {'S': 'Fri, 27 Apr 2018 14:28:06'}, {'S': 'Fri, 27 Apr 2018 14:28:07'}, {'S': 'Fri, 27 Apr 2018 14:28:08'}, {'S': 'Fri, 27 Apr 2018 14:28:09'}]}, 'driveId': {'S': '1'}, 'userId': {'S': 'devdata'}}, 'OldImage': {'score': {'L': [{'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': 'nan'}, {'S': '-0.0203111657762'}, {'S': '-0.0379806795168'}, {'S': '-0.00148993257648'}, {'S': '0.023072343844'}, {'S': '0.00075501304136'}, {'S': '0.000136965963543'}, {'S': '-0.0201446627137'}, {'S': '-0.0653481960255'}, {'S': '0.102688433734'}, {'S': '0.00011547152004'}, {'S': '-0.0738907230064'}, {'S': '0.0866256438468'}, {'S': '-1.59449896675e-06'}, {'S': '-0.00167951233662'}, {'S': '0.00896458161516'}, {'S': '-0.103395883499'}, {'S': '0.000489810043931'}, {'S': '-0.0398885698292'}, {'S': '2.27761325355e-08'}, {'S': '0.034833193082'}, {'S': '-0.0430083157312'}, {'S': '0.00763060408119'}, {'S': '-0.00741900967361'}, {'S': '0.00228055415359'}, {'S': '0.00188985542099'}, {'S': '-0.00184568401054'}, {'S': '1.54754440007e-06'}, {'S': '8.43520210225e-06'}, {'S': '-0.018573144593'}, {'S': '-0.00587048017247'}, {'S': '-0.000103925164097'}, {'S': '-0.173801806308'}, {'S': '-0.0621808863845'}, {'S': '-0.0223329036931'}, {'S': '0.00574432758843'}, {'S': '0.02913064801'}, {'S': '-0.0080250963089'}, {'S': '0.00214422902031'}, {'S': '0.00369908660085'}, {'S': '-0.307484435114'}, {'S': '-0.160691406485'}, {'S': '0.0463856001094'}, {'S': '-0.196031629624'}, {'S': '0.000278386744332'}, {'S': '-0.0253034225094'}, {'S': '-0.0618734729466'}, {'S': '-0.0102558456406'}, {'S': '0.576805380866'}, {'S': '0.00189269977714'}, {'S': '0.0758558860167'}, {'S': '2.27406347065e-05'}, {'S': '0.00116052529232'}, {'S': '-0.0162517208754'}, {'S': '-0.0138971320077'}, {'S': '-0.0954407407658'}, {'S': '-0.0348127740803'}, {'S': '0.967496766844'}, {'S': '0.0207045860688'}, {'S': '0.00554737752883'}, {'S': '6.16259589559e-05'}, {'S': '-0.00267757418445'}, {'S': '-0.405689930894'}, {'S': '-0.393976420313'}, {'S': '-0.257838291577'}, {'S': '0.00358394225776'}, {'S': '-0.0400890155931'}, {'S': '0.0877592024507'}, {'S': '0.00466994574901'}, {'S': '-0.00367460700161'}, {'S': '-0.00360673981633'}, {'S': '-0.00963583003307'}, {'S': '-0.00422707914135'}, {'S': '-0.0113042314844'}, {'S': '-0.276803465736'}, {'S': '-0.0872599608318'}, {'S': '0.0485569157434'}, {'S': '0.00313086413305'}, {'S': '-0.00702809862709'}, {'S': '-0.00131231104348'}, {'S': '-0.0291920796464'}, {'S': '-0.0713665065774'}, {'S': '-0.0559727490337'}, {'S': '-0.027040981151'}, {'S': '0.000486392254015'}, {'S': '-0.000840142024016'}, {'S': '-0.000317500428227'}, {'S': '-0.0182216119454'}, {'S': '-0.000886768085992'}, {'S': '0.00238627094217'}, {'S': '-0.0664401296621'}, {'S': '-0.0806759942323'}, {'S': '-0.126721579975'}, {'S': '-0.332355977314'}, {'S': '0.0697560517414'}, {'S': '-0.0480556331388'}, {'S': '-0.162165732708'}, {'S': '0.394988691444'}, {'S': '0.00241254980106'}]}, 'datetime': {'L': [{'S': 'Fri, 27 Apr 2018 14:24:36'}, {'S': 'Fri, 27 Apr 2018 14:24:37'}, {'S': 'Fri, 27 Apr 2018 14:24:38'}, {'S': 'Fri, 27 Apr 2018 14:24:39'}, {'S': 'Fri, 27 Apr 2018 14:24:40'}, {'S': 'Fri, 27 Apr 2018 14:24:41'}, {'S': 'Fri, 27 Apr 2018 14:24:42'}, {'S': 'Fri, 27 Apr 2018 14:24:43'}, {'S': 'Fri, 27 Apr 2018 14:24:44'}, {'S': 'Fri, 27 Apr 2018 14:24:45'}, {'S': 'Fri, 27 Apr 2018 14:24:46'}, {'S': 'Fri, 27 Apr 2018 14:24:47'}, {'S': 'Fri, 27 Apr 2018 14:24:48'}, {'S': 'Fri, 27 Apr 2018 14:24:49'}, {'S': 'Fri, 27 Apr 2018 14:24:50'}, {'S': 'Fri, 27 Apr 2018 14:24:51'}, {'S': 'Fri, 27 Apr 2018 14:24:52'}, {'S': 'Fri, 27 Apr 2018 14:24:53'}, {'S': 'Fri, 27 Apr 2018 14:24:54'}, {'S': 'Fri, 27 Apr 2018 14:24:55'}, {'S': 'Fri, 27 Apr 2018 14:24:56'}, {'S': 'Fri, 27 Apr 2018 14:24:57'}, {'S': 'Fri, 27 Apr 2018 14:24:58'}, {'S': 'Fri, 27 Apr 2018 14:24:59'}, {'S': 'Fri, 27 Apr 2018 14:25:00'}, {'S': 'Fri, 27 Apr 2018 14:25:01'}, {'S': 'Fri, 27 Apr 2018 14:25:02'}, {'S': 'Fri, 27 Apr 2018 14:25:03'}, {'S': 'Fri, 27 Apr 2018 14:25:04'}, {'S': 'Fri, 27 Apr 2018 14:25:05'}, {'S': 'Fri, 27 Apr 2018 14:25:06'}, {'S': 'Fri, 27 Apr 2018 14:25:07'}, {'S': 'Fri, 27 Apr 2018 14:25:08'}, {'S': 'Fri, 27 Apr 2018 14:25:09'}, {'S': 'Fri, 27 Apr 2018 14:25:10'}, {'S': 'Fri, 27 Apr 2018 14:25:11'}, {'S': 'Fri, 27 Apr 2018 14:25:12'}, {'S': 'Fri, 27 Apr 2018 14:25:13'}, {'S': 'Fri, 27 Apr 2018 14:25:14'}, {'S': 'Fri, 27 Apr 2018 14:25:15'}, {'S': 'Fri, 27 Apr 2018 14:25:16'}, {'S': 'Fri, 27 Apr 2018 14:25:17'}, {'S': 'Fri, 27 Apr 2018 14:25:18'}, {'S': 'Fri, 27 Apr 2018 14:25:19'}, {'S': 'Fri, 27 Apr 2018 14:25:20'}, {'S': 'Fri, 27 Apr 2018 14:25:21'}, {'S': 'Fri, 27 Apr 2018 14:25:22'}, {'S': 'Fri, 27 Apr 2018 14:25:23'}, {'S': 'Fri, 27 Apr 2018 14:25:24'}, {'S': 'Fri, 27 Apr 2018 14:25:25'}, {'S': 'Fri, 27 Apr 2018 14:25:26'}, {'S': 'Fri, 27 Apr 2018 14:25:27'}, {'S': 'Fri, 27 Apr 2018 14:25:28'}, {'S': 'Fri, 27 Apr 2018 14:25:29'}, {'S': 'Fri, 27 Apr 2018 14:25:30'}, {'S': 'Fri, 27 Apr 2018 14:25:31'}, {'S': 'Fri, 27 Apr 2018 14:25:32'}, {'S': 'Fri, 27 Apr 2018 14:25:33'}, {'S': 'Fri, 27 Apr 2018 14:25:34'}, {'S': 'Fri, 27 Apr 2018 14:25:35'}, {'S': 'Fri, 27 Apr 2018 14:25:36'}, {'S': 'Fri, 27 Apr 2018 14:25:37'}, {'S': 'Fri, 27 Apr 2018 14:25:38'}, {'S': 'Fri, 27 Apr 2018 14:25:39'}, {'S': 'Fri, 27 Apr 2018 14:25:40'}, {'S': 'Fri, 27 Apr 2018 14:25:41'}, {'S': 'Fri, 27 Apr 2018 14:25:42'}, {'S': 'Fri, 27 Apr 2018 14:25:43'}, {'S': 'Fri, 27 Apr 2018 14:25:44'}, {'S': 'Fri, 27 Apr 2018 14:25:45'}, {'S': 'Fri, 27 Apr 2018 14:25:46'}, {'S': 'Fri, 27 Apr 2018 14:25:47'}, {'S': 'Fri, 27 Apr 2018 14:25:48'}, {'S': 'Fri, 27 Apr 2018 14:25:49'}, {'S': 'Fri, 27 Apr 2018 14:25:50'}, {'S': 'Fri, 27 Apr 2018 14:25:51'}, {'S': 'Fri, 27 Apr 2018 14:25:52'}, {'S': 'Fri, 27 Apr 2018 14:25:53'}, {'S': 'Fri, 27 Apr 2018 14:25:54'}, {'S': 'Fri, 27 Apr 2018 14:25:55'}, {'S': 'Fri, 27 Apr 2018 14:25:56'}, {'S': 'Fri, 27 Apr 2018 14:25:57'}, {'S': 'Fri, 27 Apr 2018 14:25:58'}, {'S': 'Fri, 27 Apr 2018 14:25:59'}, {'S': 'Fri, 27 Apr 2018 14:26:00'}, {'S': 'Fri, 27 Apr 2018 14:26:01'}, {'S': 'Fri, 27 Apr 2018 14:26:02'}, {'S': 'Fri, 27 Apr 2018 14:26:03'}, {'S': 'Fri, 27 Apr 2018 14:26:04'}, {'S': 'Fri, 27 Apr 2018 14:26:05'}, {'S': 'Fri, 27 Apr 2018 14:26:06'}, {'S': 'Fri, 27 Apr 2018 14:26:07'}, {'S': 'Fri, 27 Apr 2018 14:26:08'}, {'S': 'Fri, 27 Apr 2018 14:26:09'}, {'S': 'Fri, 27 Apr 2018 14:26:10'}, {'S': 'Fri, 27 Apr 2018 14:26:11'}, {'S': 'Fri, 27 Apr 2018 14:26:12'}, {'S': 'Fri, 27 Apr 2018 14:26:13'}, {'S': 'Fri, 27 Apr 2018 14:26:14'}, {'S': 'Fri, 27 Apr 2018 14:26:15'}, {'S': 'Fri, 27 Apr 2018 14:26:16'}, {'S': 'Fri, 27 Apr 2018 14:26:17'}, {'S': 'Fri, 27 Apr 2018 14:26:18'}, {'S': 'Fri, 27 Apr 2018 14:26:19'}, {'S': 'Fri, 27 Apr 2018 14:26:20'}, {'S': 'Fri, 27 Apr 2018 14:26:21'}, {'S': 'Fri, 27 Apr 2018 14:26:22'}, {'S': 'Fri, 27 Apr 2018 14:26:23'}, {'S': 'Fri, 27 Apr 2018 14:26:24'}, {'S': 'Fri, 27 Apr 2018 14:26:25'}, {'S': 'Fri, 27 Apr 2018 14:26:26'}, {'S': 'Fri, 27 Apr 2018 14:26:27'}, {'S': 'Fri, 27 Apr 2018 14:26:28'}, {'S': 'Fri, 27 Apr 2018 14:26:29'}, {'S': 'Fri, 27 Apr 2018 14:26:30'}, {'S': 'Fri, 27 Apr 2018 14:26:31'}, {'S': 'Fri, 27 Apr 2018 14:26:32'}, {'S': 'Fri, 27 Apr 2018 14:26:33'}, {'S': 'Fri, 27 Apr 2018 14:26:34'}, {'S': 'Fri, 27 Apr 2018 14:26:35'}, {'S': 'Fri, 27 Apr 2018 14:26:36'}, {'S': 'Fri, 27 Apr 2018 14:26:37'}, {'S': 'Fri, 27 Apr 2018 14:26:38'}, {'S': 'Fri, 27 Apr 2018 14:26:39'}, {'S': 'Fri, 27 Apr 2018 14:26:40'}, {'S': 'Fri, 27 Apr 2018 14:26:41'}, {'S': 'Fri, 27 Apr 2018 14:26:42'}, {'S': 'Fri, 27 Apr 2018 14:26:43'}, {'S': 'Fri, 27 Apr 2018 14:26:44'}, {'S': 'Fri, 27 Apr 2018 14:26:45'}, {'S': 'Fri, 27 Apr 2018 14:26:46'}, {'S': 'Fri, 27 Apr 2018 14:26:47'}, {'S': 'Fri, 27 Apr 2018 14:26:48'}, {'S': 'Fri, 27 Apr 2018 14:26:49'}, {'S': 'Fri, 27 Apr 2018 14:26:50'}, {'S': 'Fri, 27 Apr 2018 14:26:51'}, {'S': 'Fri, 27 Apr 2018 14:26:52'}, {'S': 'Fri, 27 Apr 2018 14:26:53'}, {'S': 'Fri, 27 Apr 2018 14:26:54'}, {'S': 'Fri, 27 Apr 2018 14:26:55'}, {'S': 'Fri, 27 Apr 2018 14:26:56'}, {'S': 'Fri, 27 Apr 2018 14:26:57'}, {'S': 'Fri, 27 Apr 2018 14:26:58'}, {'S': 'Fri, 27 Apr 2018 14:26:59'}, {'S': 'Fri, 27 Apr 2018 14:27:00'}, {'S': 'Fri, 27 Apr 2018 14:27:01'}, {'S': 'Fri, 27 Apr 2018 14:27:02'}, {'S': 'Fri, 27 Apr 2018 14:27:03'}, {'S': 'Fri, 27 Apr 2018 14:27:04'}]}, 'driveId': {'S': '1'}, 'userId': {'S': 'devdata'}}, 'SequenceNumber': '65171600000000046471544884', 'SizeBytes': 11579, 'StreamViewType': 'NEW_AND_OLD_IMAGES'}, 'eventSourceARN': 'arn:aws:dynamodb:eu-west-1:265057821883:table/brum-mobilehub-858586794-DriveScores/stream/2018-04-16T12:27:06.073'}]}
# 	lambda_handler(event, 0)
# 	# for i in range(1, 4):
# 	# 	event = json.load(open("devdata{}.json".format(i), "r"))
# 	# 	lambda_handler(event, 0)
